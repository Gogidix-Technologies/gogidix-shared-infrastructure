# API Gateway Environment Configuration Template
# Copy this file to .env and update the values for your environment

# Service Configuration
SERVER_PORT=8080
SPRING_PROFILES_ACTIVE=dev
SERVICE_NAME=api-gateway

# Gateway Configuration
GATEWAY_PREFIX=/api
GATEWAY_VERSION=v1
REQUEST_TIMEOUT_MS=30000
RESPONSE_TIMEOUT_MS=30000

# Service Discovery
EUREKA_SERVER_URL=http://localhost:8761/eureka
EUREKA_INSTANCE_HOSTNAME=localhost
SERVICE_DISCOVERY_ENABLED=true
LOAD_BALANCING_STRATEGY=round-robin

# Route Configuration
DYNAMIC_ROUTING_ENABLED=true
ROUTE_REFRESH_INTERVAL_SECONDS=30
FALLBACK_URI=forward:/fallback

# Circuit Breaker Configuration
CIRCUIT_BREAKER_ENABLED=true
CIRCUIT_BREAKER_FAILURE_THRESHOLD=50
CIRCUIT_BREAKER_WAIT_DURATION_IN_OPEN_STATE=30000
CIRCUIT_BREAKER_SLIDING_WINDOW_SIZE=10

# Rate Limiting Configuration
RATE_LIMIT_ENABLED=true
GLOBAL_RATE_LIMIT_PER_SECOND=1000
USER_RATE_LIMIT_PER_MINUTE=100
API_KEY_RATE_LIMIT_PER_MINUTE=1000
RATE_LIMIT_HEADER_NAME=X-RateLimit-Limit

# CORS Configuration
CORS_ENABLED=true
CORS_ALLOWED_ORIGINS=http://localhost:3000,http://localhost:8080
CORS_ALLOWED_METHODS=GET,POST,PUT,DELETE,OPTIONS,PATCH
CORS_ALLOWED_HEADERS=*
CORS_EXPOSED_HEADERS=X-Total-Count,X-Request-ID
CORS_ALLOW_CREDENTIALS=true
CORS_MAX_AGE=3600

# Security Configuration
JWT_SECRET=your-jwt-secret-key-here
JWT_EXPIRES_IN=24h
API_KEY_HEADER=X-API-Key
OAUTH2_ENABLED=false
OAUTH2_ISSUER_URI=https://accounts.google.com

# Request/Response Logging
REQUEST_LOGGING_ENABLED=true
RESPONSE_LOGGING_ENABLED=true
BODY_LOGGING_ENABLED=false
HEADER_LOGGING_ENABLED=true
SENSITIVE_HEADERS=Authorization,X-API-Key

# Retry Configuration
RETRY_ENABLED=true
MAX_RETRY_ATTEMPTS=3
RETRY_BACKOFF_MS=1000
RETRY_ON_STATUS_CODES=502,503,504

# Health Check Configuration
HEALTH_CHECK_ENABLED=true
HEALTH_CHECK_INTERVAL_SECONDS=30
DEPENDENCY_HEALTH_CHECK_ENABLED=true
HEALTH_CHECK_TIMEOUT_MS=5000

# Metrics Configuration
METRICS_ENABLED=true
PROMETHEUS_METRICS_ENABLED=true
METRICS_ENDPOINT=/metrics
CUSTOM_METRICS_ENABLED=true

# Cache Configuration
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=
REDIS_DATABASE=17
CACHE_TTL_SECONDS=300
RESPONSE_CACHE_ENABLED=true

# Compression Configuration
COMPRESSION_ENABLED=true
COMPRESSION_MIN_RESPONSE_SIZE=1024
COMPRESSION_MIME_TYPES=text/html,text/xml,text/plain,text/css,text/javascript,application/javascript,application/json

# WebSocket Configuration
WEBSOCKET_ENABLED=true
WEBSOCKET_ENDPOINT=/ws
WEBSOCKET_HEARTBEAT_INTERVAL=25000

# SSL/TLS Configuration
SSL_ENABLED=false
SSL_KEY_STORE_PATH=/path/to/keystore.jks
SSL_KEY_STORE_PASSWORD=keystore_password
SSL_KEY_ALIAS=api-gateway
SSL_TRUST_STORE_PATH=/path/to/truststore.jks
SSL_TRUST_STORE_PASSWORD=truststore_password

# Header Manipulation
ADD_REQUEST_HEADERS=X-Request-ID,X-Forwarded-For
REMOVE_REQUEST_HEADERS=
ADD_RESPONSE_HEADERS=X-Response-Time,X-Server-Version
REMOVE_RESPONSE_HEADERS=Server

# Filter Configuration
PRE_FILTERS_ENABLED=true
POST_FILTERS_ENABLED=true
CUSTOM_FILTERS_ENABLED=true
FILTER_ORDER_CONFIG_PATH=/config/filter-order.properties

# Service Routes Configuration
# Auth Service
ROUTE_AUTH_SERVICE_PATH=/auth/**
ROUTE_AUTH_SERVICE_URL=http://auth-service:8080
ROUTE_AUTH_SERVICE_STRIP_PREFIX=1

# User Profile Service
ROUTE_USER_PROFILE_PATH=/users/**
ROUTE_USER_PROFILE_URL=http://user-profile-service:8095
ROUTE_USER_PROFILE_STRIP_PREFIX=1

# Monitoring Configuration
DISTRIBUTED_TRACING_ENABLED=true
JAEGER_ENDPOINT=http://localhost:14268/api/traces
TRACE_ID_HEADER=X-Trace-ID
SPAN_ID_HEADER=X-Span-ID

# Logging Configuration
LOG_LEVEL=INFO
LOG_LEVEL_GATEWAY=DEBUG
LOG_PATTERN_CONSOLE=%d{HH:mm:ss.SSS} [%thread] %-5level %logger{36} - %msg%n
LOG_FILE_ENABLED=true
LOG_FILE_PATH=./logs/api-gateway.log

# Performance Configuration
CONNECTION_POOL_SIZE=50
CONNECTION_TIMEOUT_MS=10000
READ_TIMEOUT_MS=30000
WRITE_TIMEOUT_MS=30000
MAX_IDLE_TIME_MS=600000

# Disaster Recovery
FALLBACK_ENABLED=true
FALLBACK_MESSAGE=Service temporarily unavailable
HYSTRIX_ENABLED=true
BULKHEAD_ENABLED=true

# JVM Configuration
JAVA_OPTS=-Xmx2g -Xms1g -XX:+UseG1GC -XX:MaxGCPauseMillis=200